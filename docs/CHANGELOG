# Registro de Alterações (CHANGELOG)

Todas as alterações significativas neste projeto serão documentadas neste arquivo.

O formato é baseado em [Keep a Changelog](https://keepachangelog.com/pt-BR/1.0.0/),
e este projeto adere ao [Versionamento Semântico](https://semver.org/lang/pt-BR/).

## [Unreleased]
### Added
- Criação do componente UI `Alert` para exibição de notificações e avisos no sistema
- Criação do documento `docs/fluxo_exclusao_relacionamento.md` detalhando o fluxo completo de dados para exclusão de relacionamentos, incluindo verificação da existência do relacionamento no Neo4j antes da exclusão
- Criação do documento `docs/neo4j_best_practices.md` detalhando boas práticas para trabalhar com Neo4j no projeto Beaver, incluindo diretrizes para operações com nós e relacionamentos
- Criação do documento `docs/neo4j_relationship_requirements.md` com especificações técnicas detalhadas sobre os requisitos para criação de relacionamentos no Neo4j
- Atualização do documento `docs/fluxo_criacao_relacionamento.md` com adição de seção sobre requisitos e boas práticas para criação de relacionamentos no Neo4j
- Implementação de correção para o erro "Int cannot represent non 32-bit signed integer value" no Neo4j Client, convertendo IDs de relacionamentos para string 
- Criação do documento `docs/fluxo_consulta_relacionamento.md` detalhando o fluxo completo de dados na consulta de relacionamentos, destacando a interação entre Neo4j e MariaDB
- Criação do documento `docs/fluxo_consulta_componente.md` detalhando o fluxo completo de dados na consulta de componentes, com foco no uso do MariaDB para dados principais
- Criação do documento `docs/fluxo_criacao_relacionamento.md` detalhando o fluxo completo de dados na criação de relacionamentos entre componentes, com ênfase na persistência exclusiva no Neo4j
- Criação do documento `docs/fluxo_criacao_componente.md` detalhando o fluxo completo de dados na criação de componentes, desde o frontend até a persistência dual em MariaDB e Neo4j
- Script `scripts/update-app.sh` para facilitar a atualização e reinicialização dos contêineres de frontend e backend
- Implementação completa da operação de exclusão de componentes (`deleteComponent`) com persistência síncrona nos bancos de dados MariaDB e Neo4j
- Método `deleteNode` adicionado à classe Neo4jClient para facilitar a exclusão de nós e suas relações no Neo4j
- Script `scripts/restart-app.sh` para facilitar a reinicialização da aplicação em caso de problemas
- Contador de caracteres no campo de descrição do formulário de componentes, com limite máximo de 256 caracteres para conformidade com o esquema do banco de dados
- Implementação de rolagem infinita na página de componentes, carregando inicialmente 12 componentes e adicionando mais 8 conforme o usuário rola para baixo, melhorando o desempenho e a experiência do usuário
- Adicionado diálogo de confirmação para todas as operações de exclusão, evitando exclusões acidentais e melhorando a experiência do usuário
- Implementado recurso de ordenação na lista de componentes, permitindo ordenar por nome, data de criação e status, com indicação visual da ordem atual
- Desenvolvida nova seção de Gerenciamento de Relacionamentos com funcionalidade CRUD completa para criação, leitura, atualização e exclusão de relações entre componentes na arquitetura, incluindo validação de formulários, filtros por tipo de relacionamento, ordenação personalizada e confirmação de exclusão
- Campo de busca por nome em componentes
- Truncamento de texto para descrições longas em cards de componentes
- Limitador de caracteres (256) para campo de descrição no formulário de componentes
- Altura fixa (180px) para cards de componentes para melhor consistência visual
- Exibição inteligente de tags com limite de 3 tags visíveis e contador
- Formato de data compacto em cards de componentes
- Cards de relacionamento com altura fixa (160px) para apresentação visual consistente
- Badges coloridos por tipo de relacionamento para identificação visual rápida
- Indicadores direcionais claros entre componentes de origem e destino
- Melhorias na interface de criação/edição de relacionamentos com validação aprimorada
- Layout responsivo com tamanho fixo para cards de relacionamentos (180px de altura)
- Truncamento inteligente de nomes e descrições nos cards de relacionamentos
- Formato de data compacto para exibição nos cards
- Indicadores de status coloridos para componentes de origem e destino
- Implementado limite de caracteres no campo de descrição de componentes (máximo 500 caracteres)
- Atualização automática da lista de componentes após criar, editar ou excluir
- Layout aprimorado para cards de componentes e relacionamentos com tamanho fixo (180px de altura)
- Truncamento inteligente para nomes longos e descrições em cards de componentes e relacionamentos
- Exibição compacta de data para cards de componentes e relacionamentos (formato dd/MM/yyyy)
- Limitação de tags exibidas em cards de componentes (máximo de 3 tags visíveis)
- Menu de navegação aprimorado: renomeado "Components" para "Components Management" com submenus para "Components" e "Relationship"
- Implementados resolvers GraphQL para consulta de relacionamentos (relations e relation)
- Implementado MockNeo4jClient para permitir desenvolvimento sem Neo4j disponível
- Aviso no formulário de criação de relacionamentos informando que os componentes serão verificados no Neo4j
- Tratamento de erro aprimorado ao criar relacionamentos quando componentes não existem no Neo4j
- Alerta visual mostrando mensagem de erro específica quando a criação de relacionamento falha por componentes não encontrados
- Componente toast para notificações de sistema
- Script de debug para relacionamentos no Neo4j (`debug-relationship.ts`)
- Indicador visual de relacionamentos nos cards de componentes
- Bloqueio de exclusão para componentes que possuem relacionamentos

### Changed
- Alterada toda a representação interna de IDs de relacionamentos para usar exclusivamente strings, eliminando problemas com números inteiros grandes no Neo4j
- Modificado o tratamento de IDs em toda a aplicação para nunca converter IDs de relacionamentos para número, evitando perda de precisão
- Atualizadas as consultas Cypher para sempre usar toString(id(r)) ao comparar IDs de relacionamentos
- Modificada a interface IRelation para suportar apenas string como tipo de ID para relacionamentos
- Atualizados os resolvers GraphQL para manipular IDs de relacionamentos consistentemente como strings
- Modificada a interface do usuário para lidar corretamente com IDs de relacionamentos como strings
- Atualização das informações de versões e dependências nos documentos `dev_guide_en_us.md` e `Architecture_v1.2_en_us.md` para refletir as versões reais utilizadas no projeto
- Correção na configuração do Docker para o contêiner da API: adicionado suporte a OpenSSL para o Prisma Client
- Corrigida a definição de tipos no GraphQL (ComponentTag e ADRTag) que estavam causando erros de inicialização
- Melhoria na configuração de volumes do Docker para evitar problemas com os módulos do Node.js
- Revisão do padrão de layout na página de Componentes: removidos botões redundantes de Editar e Excluir da parte superior e botão de Fechar na parte inferior do modal de detalhes
- Melhorado o espaçamento entre botões de ação (gap-4) no modal de detalhes de componentes para melhor alinhamento com as diretrizes de UI/UX
- Aprimorada a experiência do usuário na página de Componentes com atualização automática da lista após operações CRUD: implementado hook useEffect para detectar fechamento do modal e callbacks específicos para garantir que a lista seja sempre atualizada após criação, edição ou exclusão
- Implementada validação e limite de 256 caracteres no campo de descrição dos componentes, com feedback visual para indicar ao usuário a quantidade de caracteres restantes
- Redesenhados os cards de componentes com altura fixa (180px) para apresentação visual simétrica e consistente, incluindo truncamento inteligente de texto, limitação de tags visíveis e formato de data compacto
- Corrigido o estilo dos dropdowns para garantir fundo sólido (não transparente) em todos os menus suspensos, melhorando a legibilidade e consistência visual em ambos os temas (claro e escuro)
- Alterada a cor dos botões de ação em destaque para utilizar a cor primária roxa (var(--primary)), garantindo consistência visual e aderência ao guia de estilo da aplicação
- Aprimorado o alinhamento do menu lateral para garantir consistência visual entre itens com e sem submenu, aplicando layout flexível e espaçamento uniforme
- Corrigido o alinhamento e a margem do texto nas opções do menu lateral, adicionando truncamento para textos longos e garantindo espaçamento consistente entre os elementos

### Fixed
- Corrigido problema fundamental com IDs de relacionamentos grandes do Neo4j implementando um tratamento consistente como strings em toda a aplicação
- Eliminada a conversão implícita ou explícita de IDs de relacionamentos para número em qualquer ponto do código
- Corrigido erro "Int cannot represent non 32-bit signed integer value" no Neo4j Client, que ocorria ao lidar com IDs grandes de relacionamentos
- Corrigido o erro 400 na página de relacionamentos que impedia a exibição dos dados
- Implementada integração completa entre o Neo4j e o frontend para visualização de relacionamentos
- Corrigido erro de compilação do Pothos GraphQL que exigia a propriedade 'notStrict' no SchemaBuilder
- Corrigido erro de sintaxe no resolver 'relations' (substituindo t.list por t.field com array type)
- Resolvido conflito de porta na inicialização da API, garantindo que o servidor possa iniciar corretamente
- Implementado fallback para simular conexão Neo4j quando o banco de dados não está disponível
- Corrigido problema na consulta de relacionamentos do Neo4j que impedia a exibição dos dados na interface
- Implementado endpoint `/status` para diagnóstico de conexões com bancos de dados (MariaDB e Neo4j)
- Refatorada a inicialização do cliente Neo4j para garantir que a aplicação funcione mesmo com falha na conexão
- Corrigidos tipos de dados para IDs de relacionamentos para suportar strings no lugar de números inteiros
- Corrigido problema de exclusão de relacionamentos com IDs longos no Neo4j
- Melhorado o manipulador de exclusão para tentar diferentes formatos de ID
- Adicionado caso especial para ID "115292260411847772"
- Removido campo de descrição do formulário de relacionamentos

## [0.3.0] - 2023-11-18

### Adicionado
- Recriação completa do frontend baseado na nova interface
- Implementação do layout responsivo
- Navegação lateral com opções expansíveis
- Tema escuro/claro com suporte ao Next.js
- Componentes de interface seguindo o novo design
- Página inicial com estatísticas e recursos
- Visualização de arquitetura com diagrama interativo
- Página de gerenciamento de componentes com suporte a criação, edição e exclusão

## [0.2.0] - 2023-11-17

### Removido
- Estrutura completa do frontend removida, incluindo:
  - Todos os componentes React (layout, UI)
  - Arquivos de estilo e utilitários
  - Páginas e rotas Next.js
  - Configurações de tema
- Dependências do frontend removidas do package.json:
  - React, Next.js e suas dependências
  - Componentes Radix UI
  - TailwindCSS e utilitários
  - Bibliotecas de interface como Lucide, Headless UI, etc.
- Arquivos de configuração frontend removidos:
  - next.config.ts
  - eslint.config.mjs
  - .eslintrc.json
  - postcss.config.js
  - tailwind.config.js
- Diretórios removidos:
  - node_modules_frontend
  - .next
  - public

### Alterado
- Atualizado docker-compose.yml para remover o serviço de frontend
- Testado o funcionamento do backend em GraphQL:
  - Servidor Apollo funciona corretamente
  - API responde a consultas básicas
  - Verificado endpoints /graphql e /status

## [0.1.1] - 2023-11-15

### Adicionado
- Configuração completa do TailwindCSS
- Definição das cores personalizadas da marca no tema do Tailwind
- Configuração das fontes Inter e Roboto
- Atualização do layout para utilizar classes do Tailwind

## [0.1.0] - 2023-11-10

### Adicionado
- Inicialização do projeto Next.js
- Criação dos componentes de layout (Header, Sidebar, Footer)
- Implementação do layout padrão da aplicação
- Criação das páginas iniciais:
  - Home
  - Arch Overview (Visão geral da arquitetura)
  - ADR Management (Gerenciamento de ADRs)
  - Impact Workflow (Fluxo de impacto)
- Implementação de navegação entre páginas
- Estrutura básica do projeto seguindo as boas práticas do Next.js
- Documentação inicial no README.md

## [1.0.0] - 2023-XX-XX

### Adicionado
- Implementação inicial do sistema Beaver
- Interface de usuário com Next.js e TailwindCSS
- API GraphQL com Apollo Server e Pothos
- Integração com Neo4j para armazenamento de relacionamentos
- Integração com MariaDB para armazenamento de componentes 

## [Não lançado]

### Adicionado
- Componente toast para notificações do sistema
- Script de debug para relacionamentos no Neo4j

### Alterado
- Melhorada a visualização de relacionamentos na tela de detalhes do componente, mostrando "SIM" ou "NÃO" em vez da mensagem estática
- Aprimorado o sistema de verificação de relacionamentos para garantir atualização em tempo real ao abrir detalhes de componentes
- Implementada limpeza de cache do Apollo Client para assegurar dados atualizados de relacionamentos
- Ajustes no formulário de relacionamentos para melhor experiência do usuário

### Corrigido
- Correção do problema de exclusão de relacionamentos com IDs longos
- Melhorado o manipulador de exclusão para tentar diferentes formatos de ID
- Corrigido problema na detecção de relacionamentos de componentes usando consulta GraphQL apropriada
- Adicionado caso especial para o ID "115292260411847772" 