{"version":3,"sources":["../src/model-loader.ts"],"names":["createContextCache","PothosSchemaError","getDelegateFromModel","getModel","getClient","cacheKey","setLoaderMappings","selectionStateFromInfo","mergeSelection","selectionCompatible","selectionToQuery","ModelLoader","forRef","ref","modelName","findUnique","builder","model","name","getDefaultFindUnique","getFindUnique","findBy","parent","fields","primaryKeyName","primaryKey","key","join","getDefaultFindBy","idField","find","field","isId","uniqueField","isRequired","isUnique","uniqueIndex","uniqueIndexes","idx","every","f","getDefaultIDSelection","result","getCursorSelection","cursor","index","filter","Boolean","selection","column","getFindUniqueForField","fieldName","some","getSelection","info","parentType","path","queryCache","has","context","set","query","get","loadSelection","stageQuery","mappings","entry","staged","state","models","createResolvablePromise","promise","initLoad","initialModel","Map","add","nextTick","tick","then","delete","resolve","reject","delegate","findUniqueOrThrow","where","rejectOnNotFound","setTimeout","constructor","Set","Promise","resolveFn","rejectFn"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}