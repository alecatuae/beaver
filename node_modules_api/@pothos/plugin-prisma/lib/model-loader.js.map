{"version":3,"sources":["../src/model-loader.ts"],"names":["ModelLoader","forRef","ref","modelName","findUnique","builder","createContextCache","model","PothosSchemaError","name","getDefaultFindUnique","getFindUnique","findBy","parent","fields","primaryKeyName","primaryKey","key","join","getDefaultFindBy","getModel","idField","find","field","isId","uniqueField","isRequired","isUnique","uniqueIndex","uniqueIndexes","idx","every","f","getDefaultIDSelection","result","getCursorSelection","cursor","index","filter","Boolean","selection","column","getFindUniqueForField","fieldName","some","getSelection","info","cacheKey","parentType","path","queryCache","has","selectionStateFromInfo","context","set","query","selectionToQuery","get","loadSelection","stageQuery","mappings","setLoaderMappings","entry","staged","selectionCompatible","state","mergeSelection","models","createResolvablePromise","promise","initLoad","initialModel","Map","add","nextTick","tick","then","delete","resolve","reject","delegate","findUniqueOrThrow","where","rejectOnNotFound","setTimeout","constructor","Set","Promise","getDelegateFromModel","getClient","resolveFn","rejectFn"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}